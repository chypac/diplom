# Система обнаружения аномалий в сетевом трафике

Система анализа сетевого трафика в реальном времени для обнаружения аномального поведения с использованием автоэнкодеров.

## Описание

Система использует глубокое обучение (автоэнкодеры) для анализа сетевого трафика и обнаружения аномалий. Она способна работать в режиме реального времени, анализируя пакеты непосредственно с сетевого интерфейса.

## Функциональность

- Захват и анализ сетевого трафика в реальном времени
- Обнаружение различных типов аномалий:
  - Active Wiretap
  - ARP MitM
  - Fuzzing
  - Mirai Botnet
  - OS Scan
  - SSDP Flood
  - SSL Renegotiation
  - SYN DoS
  - Video Injection

## Требования

- Python 3.8+
- PyTorch
- Scapy
- NumPy
- scikit-learn
- keyboard

## Установка

1. Клонируйте репозиторий
2. Установите зависимости:
```bash
pip install torch numpy scikit-learn scapy keyboard
```

## Использование

1. Запустите анализатор:
```bash
python live_traffic_analyzer.py
```

2. Выберите модель из списка доступных
3. Наблюдайте за результатами анализа в реальном времени

## Формат вывода

### Анализ пакетов
```
[+] НОРМА    192.168.1.142   -> 37.235.55.201   TCP 63895 ->   443 | Отклонение: 0.0307
[!] АНОМАЛИЯ 192.168.1.142   -> 37.235.55.201   TCP 63896 ->   443 | Отклонение: 0.1523
```

- `[+]` - нормальный трафик
- `[!]` - обнаружена аномалия
- `Отклонение` - степень аномальности (чем больше, тем более подозрительный трафик)

### Статистика
Каждые 5 секунд выводится статистика:
```
=== Статистика анализа трафика ===
Всего пакетов: 100 | Норма: 95 (95.0%) | Аномалии: 5 (5.0%)
Отклонения: мин=0.0100, макс=0.1523, сред=0.0307
Скорость: 20.0 пакетов/сек
================================
```

## Структура проекта

- `live_traffic_analyzer.py` - основной скрипт запуска
- `networc_interface.py` - модуль обработки сетевого трафика
- `dataset/` - каталог с предобученными моделями
  - `Active Wiretap/`
  - `ARP MitM/`
  - и т.д.

## Как это работает

1. **Захват пакетов**: Система использует Scapy для захвата сетевого трафика в реальном времени.

2. **Извлечение признаков**: Каждый пакет преобразуется в вектор из 114 признаков, включая:
   - IP-адреса и порты
   - Флаги TCP/UDP
   - Размеры пакетов
   - Временные характеристики

3. **Нормализация**: Признаки нормализуются с помощью MinMaxScaler для приведения к единому масштабу.

4. **Анализ**: Автоэнкодер пытается реконструировать входные данные. Чем больше ошибка реконструкции (отклонение), тем вероятнее, что пакет аномальный.

5. **Классификация**: Если отклонение превышает порог (0.1), пакет считается аномальным.

## Управление

- Для смены модели во время работы нажмите клавишу 'M'
- Для завершения работы нажмите Ctrl+C

## Настройка

Основные параметры можно настроить в начале скрипта:
- `threshold` - порог определения аномалий (по умолчанию 0.1)
- Задержка между пакетами (по умолчанию 0.1 сек)
- Интервал вывода статистики (по умолчанию 5 сек)
